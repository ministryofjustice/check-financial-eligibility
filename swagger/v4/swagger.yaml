---
openapi: 3.0.1
info:
  title: API V4
  description: Check financial eligibility for legal aid
  contact:
    name: Github repository
    url: https://github.com/ministryofjustice/check-financial-eligibility
  version: v4
paths:
  "/assessments/{assessment_id}/applicant":
    post:
      summary: create applicant
      tags:
      - Assessment components
      description: |
        This endpoint will create an Applicant and associate it with
        an existing Assessment which has been created via `POST /assessments`
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                applicant:
                  type: object
                  description: Object describing pertinent applicant details
                  properties:
                    date_of_birth:
                      type: string
                      format: date
                      example: '1992-07-22'
                      description: Applicant date of birth
                    involvement_type:
                      type: string
                      enum:
                      - applicant
                      example: applicant
                      description: Applicant involvement type
                    has_partner_opponent:
                      type: boolean
                      example: false
                      description: Applicant has partner opponent
                    receives_qualifying_benefit:
                      type: boolean
                      example: false
                      description: Applicant receives qualifying benefit
        required: true
  "/assessments":
    post:
      summary: create assessment
      tags:
      - Assessment
      parameters: []
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                client_reference_id:
                  type: string
                  example: LA-FOO-BAR
                  description: Client's reference number for this application (free
                    text)
                submission_date:
                  type: string
                  description: Date of the original submission (iso8601 format)
                  example: '2022-05-17'
                proceeding_types:
                  type: object
                  description: Details of proceeding types in the application (v4
                    and above only)
                  properties:
                    ccms_codes:
                      type: array
                      description: Array of proceeding type CCMS codes
                      example:
                      - DA001
                      - SE013
                      items:
                        type: string
                        example: SE003
        required: true
  "/assessments/{id}":
    parameters:
    - name: id
      in: path
      description: Unique identifier of the assessment
      required: true
      schema:
        type: string
    get:
      summary: show assessment
      tags:
      - Assessment
      responses:
        '200':
          description: successful
  "/assessments/{assessment_id}/capitals":
    post:
      summary: create capital
      tags:
      - Assessment components
      description: |
        Adds details of an applicant's capital assets to an assessment.

        There are two types of assets:

        - bank_accounts The description should hold the Bank name and account
          number, and the value should hold the lowest balance during that calculation period (i.e. the
          month leading up to the submission date)

        - non-liquid capital items: These are other capital assets which are not immediately realisable as cash, such
          as stocks and shares, interest in a trust, valuable items, etc. Do not include property or vehicles which
          are added through separate endpoints.
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                bank_accounts:
                  type: array
                  description: One or more account details
                  example:
                  - value: 1.01
                    description: test name 1
                  - value: 100.01
                    description: test name 2
                  items:
                    type: object
                    description: Account detail
                    properties:
                      value:
                        type: number
                        format: decimal
                      description:
                        type: string
        required: true
  "/assessments/{assessment_id}/cash_transactions":
    post:
      summary: create cash_transaction
      tags:
      - Assessment components
      description: 'Add cash income and outgoings to an assessment.

        '
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              description: A set of cash income[ings] and outgoings payments by category
              example:
                income:
                - category: maintenance_in
                  payments:
                  - date: '2022-01-01'
                    amount: 1046.44
                    client_id: '05459c0f-a620-4743-9f0c-b3daa93e5711'
                  - date: '2022-02-01'
                    amount: 1034.33
                    client_id: 10318f7b-289a-4fa5-a986-fc6f499fecd0
                  - date: '2022-03-01'
                    amount: 1033.44
                    client_id: 5cf62a12-c92b-4cc1-b8ca-eeb4efbcce21
                - category: friends_or_family
                  payments:
                  - date: '2022-02-01'
                    amount: 250.0
                    client_id: e47b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-03-01'
                    amount: 266.02
                    client_id: b0c46cc7-8478-4658-a7f9-85ec85d420b1
                  - date: '2022-01-01'
                    amount: 250.0
                    client_id: f3ec68a3-8748-4ed5-971a-94d133e0efa0
                outgoings:
                - category: maintenance_out
                  payments:
                  - date: '2022-02-01'
                    amount: 256.0
                    client_id: 347b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-03-01'
                    amount: 256.0
                    client_id: 722b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-01-01'
                    amount: 256.0
                    client_id: abcb707b-d795-47c2-8b39-ccf022eae33b
                - category: child_care
                  payments:
                  - date: '2022-03-01'
                    amount: 258.0
                    client_id: ff7b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-02-01'
                    amount: 257.0
                    client_id: ee7b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-01-01'
                    amount: 256.0
                    client_id: ec7b707b-d795-47c2-8b39-ccf022eae33b
              properties:
                income:
                  type: array
                  description: One or more income details
                  items:
                    type: object
                    description: Income detail
                    properties:
                      category:
                        type: string
                        enum:
                        - benefits
                        - friends_or_family
                        - maintenance_in
                        - property_or_lodger
                        - pension
                        example: benefits
                      payments:
                        type: array
                        description: One or more payment details
                        items:
                          type: object
                          description: Payment detail
                          properties:
                            date:
                              type: string
                              format: date
                              example: '1992-07-22'
                            amount:
                              type: number
                              format: decimal
                              example: '101.01'
                            client_id:
                              type: string
                              format: uuid
                              example: '05459c0f-a620-4743-9f0c-b3daa93e5711'
                outgoings:
                  type: array
                  description: One or more outgoing details
                  items:
                    type: object
                    description: Outgoing detail
                    properties:
                      category:
                        type: string
                        enum:
                        - child_care
                        - rent_or_mortgage
                        - maintenance_out
                        - legal_aid
                        example: child_care
                      payments:
                        type: array
                        description: One or more payment details
                        items:
                          type: object
                          description: Payment detail
                          properties:
                            date:
                              type: string
                              format: date
                              example: '1992-07-22'
                            amount:
                              type: number
                              format: decimal
                              example: '101.02'
                            client_id:
                              type: string
                              format: uuid
                              example: '05459c0f-a620-4743-9f0c-b3daa93e5711'
        required: true
  "/assessments/{assessment_id}/dependants":
    post:
      summary: create dependant
      tags:
      - Assessment components
      description: 'Adds details of an applicant''s dependants.

        '
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              description: A set dependants details
              example:
                dependants:
                - date_of_birth: '1983-08-08'
                  in_full_time_education: false
                  relationship: adult_relative
                  monthly_income: 4448.63
                  assets_value: 0.0
                - date_of_birth: '1982-02-03'
                  in_full_time_education: false
                  relationship: adult_relative
                  monthly_income: 886.61
                  assets_value: 0.0
              properties:
                dependants:
                  type: array
                  description: One or more dependants details
                  items:
                    date_of_birth:
                      type: string
                      format: date
                      required: true
                      example: '1992-07-22'
                    in_full_time_education:
                      type: boolan
                      required: false
                      example: false
                      description: Dependant is in full time education or not
                    relationship:
                      type: string
                      enum:
                      - child_relative
                      - adult_relative
                      required: true
                      example: child_relative
                      description: Dependant's relationship to the applicant
                    monthly_income:
                      type: number
                      format: decimal
                      required: false
                      description: Dependant's monthly income
                      example: 101.01
                    assets_value:
                      type: number
                      format: decimal
                      required: false
                      description: Dependant's total assets value
                      example: 0.0
        required: true
  "/assessments/{assessment_id}/employments":
    post:
      summary: create employment
      tags:
      - Assessment components
      description: 'Add applicant employment income to an assessment.

        '
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              description: One or more employments incomes
              example:
                employment_income:
                - name: Job 1
                  client_id: a1d3a76f-89c7-4eae-ac51-550552f95774
                  payments:
                  - client_id: c106cc44-39a3-4494-abe8-a91dbff81ea7
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
                  - client_id: bf3356a7-681b-4a2d-bab2-a224f52f0c6f
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
                  - client_id: 66971129-6685-4acd-9deb-60581601dca6
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
                - name: Job 2
                  client_id: 27355c60-d969-459f-a283-ffbedde42ab3
                  payments:
                  - client_id: 7b8ad08f-25f5-454e-9b43-a4849d1259a1
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
                  - client_id: cc9bd6d9-9680-43d6-890b-bc06a12da124
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
                  - client_id: 46f99ca3-9702-4fbc-b824-b68908884f06
                    date: '2021-10-30'
                    gross: 1046.0
                    benefits_in_kind: 16.6
                    tax: -104.1
                    national_insurance: -18.66
                    net_employment_income: 898.84
              properties:
                employment_income:
                  type: array
                  description: One or more employment income details
                  items:
                    type: object
                    description: Employment income detail
                    properties:
                      name:
                        type: string
                        required: true
                        description: Identifying name for this employment - e.g. employer's
                          name
                      client_id:
                        type: string
                        format: uuid
                        required: true
                        description: Client supplied id to identify the employment
                      payments:
                        type: array
                        description: One or more employment payment details
                        items:
                          type: object
                          description: Employment payment detail
                          properties:
                            client_id:
                              type: string
                              format: uuid
                              required: true
                              description: Client supplied id to identify the payment
                              example: '05459c0f-a620-4743-9f0c-b3daa93e5711'
                            date:
                              type: string
                              format: date
                              required: true
                              description: Date payment received
                              example: '1992-07-22'
                            gross:
                              type: number
                              format: decimal
                              required: true
                              description: Gross payment income received
                              example: '101.01'
                            benefits_in_kind:
                              type: number
                              format: decimal
                              required: true
                              description: Benefit in kind amount received
                            tax:
                              type: number
                              format: decimal
                              required: true
                              description: Amount of tax paid
                            national_insurance:
                              type: number
                              format: decimal
                              required: true
                              description: Amount of national insurance paid
                            net_employment_income:
                              type: number
                              format: decimal
                              required: true
                              description: Net payment income received
        required: true
  "/assessments/{assessment_id}/irregular_incomes":
    post:
      summary: create irregular_income
      tags:
      - Assessment components
      description: 'Add applicant''s irregular income payments to an assessment.

        '
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              description: A set of irregular income payments
              example:
                payments:
                - income_type: student_loan
                  frequency: annual
                  amount: 123456.78
              properties:
                payments:
                  type: array
                  description: One or more irregular payment details
                  items:
                    type: object
                    description: Irregular payment detail
                    properties:
                      income_type:
                        type: string
                        enum:
                        - student_loan
                        required: true
                        description: Identifying name for this irregular income payment
                        example: student_loan
                      frequency:
                        type: string
                        enum:
                        - annual
                        required: true
                        description: Frequency of the payment received
                        example: annual
                      amount:
                        type: number
                        format: decimal
                        example: 101.01
        required: true
  "/state_benefit_type":
    get:
      summary: list state_benefit_types
      tags:
      - Lookups
      responses:
        '200':
          description: successful
