---
openapi: 3.0.1
info:
  title: API V4
  description: Check financial eligibility for legal aid
  contact:
    name: Github repository
    url: https://github.com/ministryofjustice/check-financial-eligibility
  version: v4
paths:
  "/assessments/{assessment_id}/applicant":
    post:
      summary: create applicant
      tags:
      - Assessment components
      description: |
        This endpoint will create an Applicant and associate it with
        an existing Assessment which has been created via `POST /assessments`
      parameters:
      - name: assessment_id
        in: path
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                applicant:
                  type: object
                  description: Object describing pertinent applicant details
                  properties:
                    date_of_birth:
                      type: string
                      format: date
                      example: '1992-07-22'
                      description: Applicant date of birth
                    involvement_type:
                      type: string
                      example: applicant
                      description: Applicant involvement type
                    has_partner_opponent:
                      type: boolean
                      example: false
                      description: Applicant has partner opponent
                    receives_qualifying_benefit:
                      type: boolean
                      example: false
                      description: Applicant receives qualifying benefit
        required: true
  "/assessments":
    post:
      summary: create assessment
      tags:
      - Assessment
      parameters: []
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                client_reference_id:
                  type: string
                  example: LA-FOO-BAR
                  description: Client's reference number for this application (free
                    text)
                submission_date:
                  type: string
                  description: Date of the original submission (iso8601 format)
                  example: '2022-05-16'
                proceeding_types:
                  type: object
                  description: Details of proceeding types in the application (v4
                    and above only)
                  properties:
                    ccms_codes:
                      type: array
                      description: Array of proceeding type CCMS codes
                      example:
                      - DA001
                      - SE013
                      items:
                        type: string
                        example: SE003
        required: true
  "/assessments/{id}":
    parameters:
    - name: id
      in: path
      description: Unique identifier of the assessment
      required: true
      schema:
        type: string
    get:
      summary: show assessment
      tags:
      - Assessment
      responses:
        '200':
          description: successful
  "/assessments/{assessment_id}/capitals":
    post:
      summary: create capital
      tags:
      - Assessment components
      description: |
        Adds details of an applicant's capital assets to an assessment.

        There are two types of assets:

        - bank_accounts The description should hold the Bank name and account
          number, and the value should hold the lowest balance during that calculation period (i.e. the
          month leading up to the submission date)

        - non-liquid capital items: These are other capital assets which are not immediately realisable as cash, such
          as stocks and shares, interest in a trust, valuable items, etc. Do not include property or vehicles which
          are added through separate endpoints.
      parameters:
      - name: assessment_id
        in: path
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                bank_accounts:
                  type: array
                  description: One or more account details
                  example:
                  - value: 1.01
                    description: test name 1
                  - value: 100.01
                    description: test name 2
                  items:
                    type: object
                    description: Account detail
                    properties:
                      value:
                        type: number
                        format: decimal
                      description:
                        type: string
        required: true
  "/assessments/{assessment_id}/cash_transactions":
    post:
      summary: create cash_transaction
      tags:
      - Assessment components
      description: 'Adds cash income and outgoings to an assessment so that they can
        be included in the means test.

        '
      parameters:
      - name: assessment_id
        in: path
        format: uuid
        description: Unique identifier of the assessment
        required: true
        schema:
          type: string
      responses:
        '200':
          description: successful
        '422':
          description: Unprocessable Entity
      requestBody:
        content:
          application/json:
            schema:
              type: object
              description: A set of cash income[ings] and outgoings payments by category
              example:
                income:
                - category: maintenance_in
                  payments:
                  - date: '2022-01-01'
                    amount: 1046.44
                    client_id: '05459c0f-a620-4743-9f0c-b3daa93e5711'
                  - date: '2022-02-01'
                    amount: 1034.33
                    client_id: 10318f7b-289a-4fa5-a986-fc6f499fecd0
                  - date: '2022-03-01'
                    amount: 1033.44
                    client_id: 5cf62a12-c92b-4cc1-b8ca-eeb4efbcce21
                - category: friends_or_family
                  payments:
                  - date: '2022-02-01'
                    amount: 250.0
                    client_id: e47b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-03-01'
                    amount: 266.02
                    client_id: b0c46cc7-8478-4658-a7f9-85ec85d420b1
                  - date: '2022-01-01'
                    amount: 250.0
                    client_id: f3ec68a3-8748-4ed5-971a-94d133e0efa0
                outgoings:
                - category: maintenance_out
                  payments:
                  - date: '2022-02-01'
                    amount: 256.0
                    client_id: 347b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-03-01'
                    amount: 256.0
                    client_id: 722b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-01-01'
                    amount: 256.0
                    client_id: abcb707b-d795-47c2-8b39-ccf022eae33b
                - category: child_care
                  payments:
                  - date: '2022-03-01'
                    amount: 258.0
                    client_id: ff7b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-02-01'
                    amount: 257.0
                    client_id: ee7b707b-d795-47c2-8b39-ccf022eae33b
                  - date: '2022-01-01'
                    amount: 256.0
                    client_id: ec7b707b-d795-47c2-8b39-ccf022eae33b
              properties:
                income:
                  type: array
                  description: One or more income details
                  items:
                    type: object
                    description: Income detail
                    properties:
                      category:
                        type: string
                        example: maintenance_in
                      payments:
                        type: array
                        description: One or more payment details
                        items:
                          type: object
                          description: Payment detail
                          properties:
                            date:
                              type: string
                              format: date
                              example: '1992-07-22'
                            amount:
                              type: number
                              format: decimal
                              example: '101.01'
                            client_id:
                              type: string
                              format: uuid
                              example: '05459c0f-a620-4743-9f0c-b3daa93e5711'
                outgoings:
                  type: array
                  description: One or more outgoing details
                  items:
                    type: object
                    description: Outgoing detail
                    properties:
                      category:
                        type: string
                        example: maintenance_out
                      payments:
                        type: array
                        description: One or more payment details
                        items:
                          type: object
                          description: Payment detail
                          properties:
                            date:
                              type: string
                              format: date
                              example: '1992-07-22'
                            amount:
                              type: number
                              format: decimal
                              example: '101.02'
                            client_id:
                              type: string
                              format: uuid
                              example: '05459c0f-a620-4743-9f0c-b3daa93e5711'
        required: true
  "/state_benefit_type":
    get:
      summary: list state_benefit_types
      tags:
      - Lookups
      responses:
        '200':
          description: successful
